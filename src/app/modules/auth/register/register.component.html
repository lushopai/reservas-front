<div class="register-container">
  <div class="register-content">
    <!-- Card de Registro -->
    <mat-card class="register-card">
      <!-- Header -->
      <mat-card-header class="register-header">
        <mat-card-title class="text-center">
          <mat-icon class="header-icon">person_add</mat-icon>
          <h1>Crear Cuenta</h1>
          <p>Sistema de Reservas</p>
        </mat-card-title>
      </mat-card-header>

      <!-- Body -->
      <mat-card-content class="register-body">
        <p class="form-subtitle">Complete el formulario para crear su cuenta</p>

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

          <!-- Nombres y Apellidos -->
          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Nombres *</mat-label>
              <mat-icon matPrefix>person</mat-icon>
              <input matInput type="text" formControlName="nombres" placeholder="Juan Carlos" autocomplete="given-name">
              <mat-error *ngIf="f['nombres'].hasError('required')">
                Los nombres son obligatorios
              </mat-error>
              <mat-error *ngIf="f['nombres'].hasError('minlength')">
                Mínimo 2 caracteres
              </mat-error>
              <mat-error *ngIf="f['nombres'].hasError('maxlength')">
                Máximo 50 caracteres
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Apellidos *</mat-label>
              <mat-icon matPrefix>person</mat-icon>
              <input matInput type="text" formControlName="apellidos" placeholder="Pérez González"
                autocomplete="family-name">
              <mat-error *ngIf="f['apellidos'].hasError('required')">
                Los apellidos son obligatorios
              </mat-error>
              <mat-error *ngIf="f['apellidos'].hasError('minlength')">
                Mínimo 2 caracteres
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Email -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Correo Electrónico *</mat-label>
            <mat-icon matPrefix>email</mat-icon>
            <input matInput type="email" formControlName="email" placeholder="ejemplo@correo.com" autocomplete="email">
            <mat-error *ngIf="f['email'].hasError('required')">
              El correo es obligatorio
            </mat-error>
            <mat-error *ngIf="f['email'].hasError('email')">
              Ingrese un correo válido
            </mat-error>
          </mat-form-field>

          <!-- Teléfono -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Teléfono *</mat-label>
            <mat-icon matPrefix>phone</mat-icon>
            <input matInput type="tel" formControlName="telefono" placeholder="912345678" maxlength="9"
              autocomplete="tel">
            <mat-hint>9 dígitos (ej: 912345678)</mat-hint>
            <mat-error *ngIf="f['telefono'].hasError('required')">
              El teléfono es obligatorio
            </mat-error>
            <mat-error
              *ngIf="f['telefono'].hasError('pattern') || f['telefono'].hasError('minlength') || f['telefono'].hasError('maxlength')">
              Debe tener exactamente 9 dígitos
            </mat-error>
          </mat-form-field>

          <!-- Tipo de Documento y Número -->
          <div class="form-row">
            <mat-form-field appearance="outline" class="small-width">
              <mat-label>Tipo Doc. *</mat-label>
              <mat-icon matPrefix>badge</mat-icon>
              <mat-select formControlName="tipoDocumento">
                <mat-option *ngFor="let tipo of tiposDocumento" [value]="tipo.value">
                  {{ tipo.label }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field appearance="outline" class="large-width">
              <mat-label>Número de Documento *</mat-label>
              <input matInput type="text" formControlName="documento" placeholder="12.345.678-9"
                (input)="formatearRUT($event)" maxlength="12">
              <mat-hint *ngIf="f['tipoDocumento'].value === 'RUT'">Formato: XX.XXX.XXX-X</mat-hint>
              <mat-error *ngIf="f['documento'].hasError('required')">
                El documento es obligatorio
              </mat-error>
              <mat-error *ngIf="f['documento'].hasError('rutInvalido')">
                RUT inválido
              </mat-error>
            </mat-form-field>
          </div>

          <mat-divider class="section-divider"></mat-divider>

          <!-- Contraseña -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Contraseña *</mat-label>
            <mat-icon matPrefix>lock</mat-icon>
            <input matInput [type]="showPassword ? 'text' : 'password'" formControlName="password"
              placeholder="••••••••" autocomplete="new-password">
            <button mat-icon-button matSuffix type="button" (click)="togglePassword()">
              <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-hint>Mínimo 6 caracteres</mat-hint>
            <mat-error *ngIf="f['password'].hasError('required')">
              La contraseña es obligatoria
            </mat-error>
            <mat-error *ngIf="f['password'].hasError('minlength')">
              Mínimo 6 caracteres
            </mat-error>
          </mat-form-field>

          <!-- Confirmar Contraseña -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Confirmar Contraseña *</mat-label>
            <mat-icon matPrefix>lock</mat-icon>
            <input matInput [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword"
              placeholder="••••••••" autocomplete="new-password">
            <button mat-icon-button matSuffix type="button" (click)="toggleConfirmPassword()">
              <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error *ngIf="f['confirmPassword'].hasError('required')">
              Debe confirmar la contraseña
            </mat-error>
            <mat-error *ngIf="f['confirmPassword'].hasError('passwordMismatch')">
              Las contraseñas no coinciden
            </mat-error>
          </mat-form-field>

          <!-- Términos y Condiciones -->
          <div class="terms-section">
            <mat-checkbox formControlName="aceptaTerminos">
              <span class="terms-text">
                Acepto los <a href="#" class="terms-link">términos y condiciones</a>
                y la <a href="#" class="terms-link">política de privacidad</a> *
              </span>
            </mat-checkbox>
            <mat-error *ngIf="f['aceptaTerminos'].invalid && f['aceptaTerminos'].touched" class="terms-error">
              Debe aceptar los términos y condiciones
            </mat-error>
          </div>

          <!-- Botón Registrar -->
          <button mat-raised-button color="primary" type="submit" class="register-button" [disabled]="loading">
            <ng-container *ngIf="!loading">
              <mat-icon>person_add</mat-icon>
              Crear Cuenta
            </ng-container>
            <ng-container *ngIf="loading">
              <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
              Creando cuenta...
            </ng-container>
          </button>
        </form>
      </mat-card-content>

      <mat-divider></mat-divider>

      <!-- Footer -->
      <mat-card-actions class="register-footer">
        <p class="login-text">
          ¿Ya tienes cuenta?
          <a href="javascript:void(0)" (click)="goToLogin()" class="login-link">
            Inicia sesión aquí
          </a>
        </p>
      </mat-card-actions>
    </mat-card>

    <!-- Info adicional -->
    <div class="footer-info">
      <mat-icon class="security-icon">shield</mat-icon>
      <p class="security-text">Tus datos están protegidos y seguros</p>
    </div>
  </div>
</div>